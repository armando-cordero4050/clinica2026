Simplified script with better error handling and fallbacks
